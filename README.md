# A Multi-vehicle Joint Trajectory Generator for Complex and Rare Scenarios

>  MJTG: A Multi-vehicle Joint Trajectory Generator for Complex and Rare Scenarios
>
> [Ye Tian](https://tops.tongji.edu.cn/info/1031/1185.htm)^1^^,^ ^*^, [Wentao Zheng](https://tops.tongji.edu.cn/info/1084/1480.htm)^1^, [Yinghao Shao](https://tops.tongji.edu.cn/info/1135/1782.htm)^1^, [He Zhang](https://tops.tongji.edu.cn/info/1033/1192.htm)^1^ and [Jian Sun](https://tops.tongji.edu.cn/info/1031/1187.htm)^1^
>
> ^1^Tongji University
>
> ^*^Correspondance：tianye@tongji.edu.cn

+ This repo is intended to serve as an introduction to our work. A data-driven method named the Multi-vehicle Joint Trajectory Generator (**MJTG**) framework is designed to selectively generate non-collected but potentially feasible scenarios.

![Display of Generated Cutin Scenarios](src/Display of Generated Cutin Scenarios.gif)

+ Updates:
	+ Mar 19, 2025: Initial repo



## Quick Start



### Environment Setup

Ensure the following prerequisites are satisfied. We recommend using conda for Python environment management.

+ Create and activate a conda environment:

``````bash
conda create --name MISG python=3.8
``````

+ Upgrade pip to the latest version:

``````bash
python -m pip install --upgrade pip
``````



### Requires:

+ PyTorch = 2.0.0
+ cudnn = 8.6.0
+ cuda = 11.8

**Note: ** The version number provided is the one used by the author, higher than this combination should not be a problem



### Install Packages

``````bash
pip install -r requirements.txt
``````



### Generate cutin scenarios from pre-trained models

1. Generate cutin scenes with lower fidelity through the VAE module

``````bash
cd naive_VAE/
python main.py -type 1 -sample_batch_size 1500
``````

+ `type` is the model mode and 1 represents generation；`sample_batch_size` is the number of scenarios generated in a single run

+ The generated scenario trajectories are stored as `npy` under `. /naive_VAE/processed/samples`

2. Generate cutin scenarios with high fidelity through E-WGAN and VAE modules

``````bash
cd E-WGAN/
python main.py -type 1 -sample_batch_size 1500
``````

+ `type` is the model mode and 1 represents generation；`sample_batch_size` is the number of scenarios generated in a single run

+ The generated scenario trajectories are stored as `npy` under `. /E-WGAN/processed/samples`

+ This will generate two separate files, `data_with_latent_cons` for high fidelity trajectories generated by VAE and E-WGAN, and `data_without_latent_cons` for low fidelity trajectories generated by VAE only.

3. Generate high fidelity and highly directional cutin scenarios with the VAE, E-WGAN and D-WGAN modules

``````bash
cd D-WGAN/
python main.py -type 1 -sample_batch_size 1500
``````

+ `type` is the model mode and 1 represents generation；`sample_batch_size` is the number of scenarios generated in a single run
+ The generated scenario trajectories are stored as `npy` under `. /D-WGAN/processed/samples`

+ This will generate three separate files, `data_modify_twice` for high fidelity and highly directional trajectories generated by VAE, E-WGAN and D-WGAN, `data_modify_once` for high fidelity trajectories generated by VAE and E-WGAN, and `origin` for low fidelity trajectories generated by VAE only.



## Acknowledgement & Disclaimer

The code and resources provided in this project are for informational and learning purposes only. While every effort has been made to ensure their accuracy and reliability during the development process, we are not responsible for any direct or indirect damages arising from the use of this project. Users should evaluate the suitability of the code by themselves and make appropriate modifications and tests according to their needs.



## Demonstration

We made a video to demonstrate the scenarios generated by our approach.

![Supplementary_Movie](src/Supplementary_Movie.gif)



